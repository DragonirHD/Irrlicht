import{C as b,Da as h,L as l,c as o,fb as a,h as c,mb as m,ra as v}from"./chunk-7JQNXT2W.js";var u=class n{constructor(e){this.element=e}debounceTime=0;threshold=.2;visible=new v;observer;subject$=new c;ngOnInit(){this.createObserver()}ngAfterViewInit(){this.startObservingElements()}ngOnDestroy(){this.observer&&(this.observer.disconnect(),this.observer=void 0),this.subject$.complete()}isVisible(e){return new Promise(t=>{let i=new IntersectionObserver(([s])=>{t(s.intersectionRatio>=this.threshold),i.disconnect()});i.observe(e)})}createObserver(){let e={rootMargin:"0px",threshold:this.threshold},t=i=>i.isIntersecting||i.intersectionRatio>=this.threshold;this.observer=new IntersectionObserver((i,s)=>{i.forEach(r=>{t(r)&&this.subject$.next({entry:r,observer:s})})},e)}startObservingElements(){this.observer&&(this.observer.observe(this.element.nativeElement),this.subject$.pipe(l(this.debounceTime),b(Boolean)).subscribe(i=>o(this,[i],function*({entry:e,observer:t}){let s=e.target;(yield this.isVisible(s))&&(this.visible.emit(s),t.unobserve(s))})))}static \u0275fac=function(t){return new(t||n)(a(h))};static \u0275dir=m({type:n,selectors:[["","observeVisibility",""]],inputs:{debounceTime:"debounceTime",threshold:"threshold"},outputs:{visible:"visible"}})};export{u as a};
